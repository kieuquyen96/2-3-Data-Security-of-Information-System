using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace Index
{
    public static class Sboxes
    {
        public static String S_boxes(String input)
        {
            String s1, s2, s3, s4, s5, s6, s7, s8;
            s1 = input.Substring(0, 6);
            s2 = input.Substring(6, 6);
            s3 = input.Substring(12, 6);
            s4 = input.Substring(18, 6);
            s5 = input.Substring(24, 6);
            s6 = input.Substring(30, 6);
            s7 = input.Substring(36, 6);
            s8 = input.Substring(42, 6);
            return S1(s1) + S2(s2) + S3(s3) + S4(s4) + S5(s5) + S6(s6) + S7(s7) + S8(s8);
        }
        private static int BinToDec(String bin)
        {
            return Convert.ToInt32(bin, 2);
        }
        private static String HexToBin(String hexvalue)
        {
            return hexvalue.Aggregate(new StringBuilder(), (builder, c) =>
                    builder.Append(Convert.ToString(Convert.ToInt64(c.ToString(), 16), 2).PadLeft(4, '0'))).ToString();
        }
        private static String S1(String input)
        {
            String[,] t = new String[4, 16];
            t[0, 0] = "E"; t[0, 1] = "4"; t[0, 2] = "D"; t[0, 3] = "1"; t[0, 4] = "2"; t[0, 5] = "F"; t[0, 6] = "B"; t[0, 7] = "8";
            t[0, 8] = "3"; t[0, 9] = "A"; t[0, 10] = "6"; t[0, 11] = "C"; t[0, 12] = "5"; t[0, 13] = "9"; t[0, 14] = "0"; t[0, 15] = "7";
            t[1, 0] = "0"; t[1, 1] = "F"; t[1, 2] = "7"; t[1, 3] = "4"; t[1, 4] = "E"; t[1, 5] = "2"; t[1, 6] = "D"; t[1, 7] = "1";
            t[1, 8] = "A"; t[1, 9] = "6"; t[1, 10] = "C"; t[1, 11] = "B"; t[1, 12] = "9"; t[1, 13] = "5"; t[1, 14] = "3"; t[1, 15] = "8";
            t[2, 0] = "4"; t[2, 1] = "1"; t[2, 2] = "E"; t[2, 3] = "8"; t[2, 4] = "D"; t[2, 5] = "6"; t[2, 6] = "2"; t[2, 7] = "B";
            t[2, 8] = "F"; t[2, 9] = "C"; t[2, 10] = "9"; t[2, 11] = "7"; t[2, 12] = "3"; t[2, 13] = "A"; t[2, 14] = "5"; t[2, 15] = "0";
            t[3, 0] = "F"; t[3, 1] = "C"; t[3, 2] = "8"; t[3, 3] = "2"; t[3, 4] = "4"; t[3, 5] = "9"; t[3, 6] = "1"; t[3, 7] = "7";
            t[3, 8] = "5"; t[3, 9] = "B"; t[3, 10] = "3"; t[3, 11] = "E"; t[3, 12] = "A"; t[3, 13] = "0"; t[3, 14] = "6"; t[3, 15] = "D";
            int row = BinToDec("" + input[0] + input[5]);
            int col = BinToDec("" + input[1] + input[2] + input[3] + input[4]);
            return HexToBin(t[row, col]);
        }
        private static String S2(String input)
        {
            String[,] t = new String[4, 16];
            t[0, 0] = "F"; t[0, 1] = "1"; t[0, 2] = "8"; t[0, 3] = "E"; t[0, 4] = "6"; t[0, 5] = "B"; t[0, 6] = "3"; t[0, 7] = "4";
            t[0, 8] = "9"; t[0, 9] = "7"; t[0, 10] = "2"; t[0, 11] = "D"; t[0, 12] = "C"; t[0, 13] = "0"; t[0, 14] = "5"; t[0, 15] = "A";
            t[1, 0] = "3"; t[1, 1] = "D"; t[1, 2] = "4"; t[1, 3] = "7"; t[1, 4] = "F"; t[1, 5] = "2"; t[1, 6] = "8"; t[1, 7] = "E";
            t[1, 8] = "C"; t[1, 9] = "0"; t[1, 10] = "1"; t[1, 11] = "A"; t[1, 12] = "6"; t[1, 13] = "9"; t[1, 14] = "B"; t[1, 15] = "5";
            t[2, 0] = "0"; t[2, 1] = "E"; t[2, 2] = "7"; t[2, 3] = "B"; t[2, 4] = "A"; t[2, 5] = "4"; t[2, 6] = "D"; t[2, 7] = "1";
            t[2, 8] = "5"; t[2, 9] = "8"; t[2, 10] = "C"; t[2, 11] = "6"; t[2, 12] = "9"; t[2, 13] = "3"; t[2, 14] = "2"; t[2, 15] = "F";
            t[3, 0] = "D"; t[3, 1] = "8"; t[3, 2] = "A"; t[3, 3] = "1"; t[3, 4] = "3"; t[3, 5] = "F"; t[3, 6] = "4"; t[3, 7] = "2";
            t[3, 8] = "B"; t[3, 9] = "6"; t[3, 10] = "7"; t[3, 11] = "C"; t[3, 12] = "0"; t[3, 13] = "5"; t[3, 14] = "E"; t[3, 15] = "9";
            int row = BinToDec("" + input[0] + input[5]);
            int col = BinToDec("" + input[1] + input[2] + input[3] + input[4]);
            return HexToBin(t[row, col]);
        }
        private static String S3(String input)
        {
            String[,] t = new String[4, 16];
            t[0, 0] = "A"; t[0, 1] = "0"; t[0, 2] = "9"; t[0, 3] = "E"; t[0, 4] = "6"; t[0, 5] = "3"; t[0, 6] = "F"; t[0, 7] = "5";
            t[0, 8] = "1"; t[0, 9] = "D"; t[0, 10] = "C"; t[0, 11] = "7"; t[0, 12] = "B"; t[0, 13] = "4"; t[0, 14] = "2"; t[0, 15] = "8";
            t[1, 0] = "D"; t[1, 1] = "7"; t[1, 2] = "0"; t[1, 3] = "9"; t[1, 4] = "3"; t[1, 5] = "4"; t[1, 6] = "6"; t[1, 7] = "A";
            t[1, 8] = "2"; t[1, 9] = "8"; t[1, 10] = "5"; t[1, 11] = "E"; t[1, 12] = "C"; t[1, 13] = "B"; t[1, 14] = "F"; t[1, 15] = "1";
            t[2, 0] = "D"; t[2, 1] = "6"; t[2, 2] = "4"; t[2, 3] = "9"; t[2, 4] = "8"; t[2, 5] = "F"; t[2, 6] = "3"; t[2, 7] = "0";
            t[2, 8] = "B"; t[2, 9] = "1"; t[2, 10] = "2"; t[2, 11] = "C"; t[2, 12] = "5"; t[2, 13] = "A"; t[2, 14] = "E"; t[2, 15] = "7";
            t[3, 0] = "1"; t[3, 1] = "A"; t[3, 2] = "D"; t[3, 3] = "0"; t[3, 4] = "6"; t[3, 5] = "9"; t[3, 6] = "8"; t[3, 7] = "7";
            t[3, 8] = "4"; t[3, 9] = "F"; t[3, 10] = "E"; t[3, 11] = "3"; t[3, 12] = "B"; t[3, 13] = "5"; t[3, 14] = "2"; t[3, 15] = "C";
            int row = BinToDec("" + input[0] + input[5]);
            int col = BinToDec("" + input[1] + input[2] + input[3] + input[4]);
            return HexToBin(t[row, col]);
        }
        private static String S4(String input)
        {
            String[,] t = new String[4, 16];
            t[0, 0] = "7"; t[0, 1] = "D"; t[0, 2] = "E"; t[0, 3] = "3"; t[0, 4] = "0"; t[0, 5] = "6"; t[0, 6] = "9"; t[0, 7] = "A";
            t[0, 8] = "1"; t[0, 9] = "2"; t[0, 10] = "8"; t[0, 11] = "5"; t[0, 12] = "B"; t[0, 13] = "C"; t[0, 14] = "4"; t[0, 15] = "F";
            t[1, 0] = "D"; t[1, 1] = "8"; t[1, 2] = "B"; t[1, 3] = "5"; t[1, 4] = "6"; t[1, 5] = "F"; t[1, 6] = "0"; t[1, 7] = "3";
            t[1, 8] = "4"; t[1, 9] = "7"; t[1, 10] = "2"; t[1, 11] = "C"; t[1, 12] = "1"; t[1, 13] = "A"; t[1, 14] = "E"; t[1, 15] = "9";
            t[2, 0] = "A"; t[2, 1] = "6"; t[2, 2] = "9"; t[2, 3] = "0"; t[2, 4] = "C"; t[2, 5] = "B"; t[2, 6] = "7"; t[2, 7] = "D";
            t[2, 8] = "F"; t[2, 9] = "1"; t[2, 10] = "3"; t[2, 11] = "E"; t[2, 12] = "5"; t[2, 13] = "2"; t[2, 14] = "8"; t[2, 15] = "4";
            t[3, 0] = "3"; t[3, 1] = "F"; t[3, 2] = "0"; t[3, 3] = "6"; t[3, 4] = "A"; t[3, 5] = "1"; t[3, 6] = "D"; t[3, 7] = "8";
            t[3, 8] = "9"; t[3, 9] = "4"; t[3, 10] = "5"; t[3, 11] = "B"; t[3, 12] = "C"; t[3, 13] = "7"; t[3, 14] = "2"; t[3, 15] = "E";
            int row = BinToDec("" + input[0] + input[5]);
            int col = BinToDec("" + input[1] + input[2] + input[3] + input[4]);
            return HexToBin(t[row, col]);
        }
        private static String S5(String input)
        {
            String[,] t = new String[4, 16];
            t[0, 0] = "2"; t[0, 1] = "C"; t[0, 2] = "4"; t[0, 3] = "1"; t[0, 4] = "7"; t[0, 5] = "A"; t[0, 6] = "B"; t[0, 7] = "6";
            t[0, 8] = "8"; t[0, 9] = "5"; t[0, 10] = "3"; t[0, 11] = "F"; t[0, 12] = "D"; t[0, 13] = "0"; t[0, 14] = "E"; t[0, 15] = "9";
            t[1, 0] = "E"; t[1, 1] = "B"; t[1, 2] = "2"; t[1, 3] = "C"; t[1, 4] = "4"; t[1, 5] = "7"; t[1, 6] = "D"; t[1, 7] = "1";
            t[1, 8] = "5"; t[1, 9] = "0"; t[1, 10] = "F"; t[1, 11] = "A"; t[1, 12] = "3"; t[1, 13] = "9"; t[1, 14] = "8"; t[1, 15] = "6";
            t[2, 0] = "4"; t[2, 1] = "2"; t[2, 2] = "1"; t[2, 3] = "B"; t[2, 4] = "A"; t[2, 5] = "D"; t[2, 6] = "7"; t[2, 7] = "8";
            t[2, 8] = "F"; t[2, 9] = "9"; t[2, 10] = "C"; t[2, 11] = "5"; t[2, 12] = "6"; t[2, 13] = "3"; t[2, 14] = "0"; t[2, 15] = "E";
            t[3, 0] = "B"; t[3, 1] = "8"; t[3, 2] = "C"; t[3, 3] = "7"; t[3, 4] = "1"; t[3, 5] = "E"; t[3, 6] = "2"; t[3, 7] = "D";
            t[3, 8] = "6"; t[3, 9] = "F"; t[3, 10] = "0"; t[3, 11] = "9"; t[3, 12] = "A"; t[3, 13] = "4"; t[3, 14] = "5"; t[3, 15] = "3";
            int row = BinToDec("" + input[0] + input[5]);
            int col = BinToDec("" + input[1] + input[2] + input[3] + input[4]);
            return HexToBin(t[row, col]);
        }
        private static String S6(String input)
        {
            String[,] t = new String[4, 16];
            t[0, 0] = "C"; t[0, 1] = "1"; t[0, 2] = "A"; t[0, 3] = "F"; t[0, 4] = "9"; t[0, 5] = "2"; t[0, 6] = "6"; t[0, 7] = "8";
            t[0, 8] = "0"; t[0, 9] = "D"; t[0, 10] = "3"; t[0, 11] = "4"; t[0, 12] = "E"; t[0, 13] = "7"; t[0, 14] = "5"; t[0, 15] = "B";
            t[1, 0] = "A"; t[1, 1] = "F"; t[1, 2] = "4"; t[1, 3] = "2"; t[1, 4] = "7"; t[1, 5] = "C"; t[1, 6] = "9"; t[1, 7] = "5";
            t[1, 8] = "6"; t[1, 9] = "1"; t[1, 10] = "D"; t[1, 11] = "E"; t[1, 12] = "0"; t[1, 13] = "B"; t[1, 14] = "3"; t[1, 15] = "8";
            t[2, 0] = "9"; t[2, 1] = "E"; t[2, 2] = "F"; t[2, 3] = "5"; t[2, 4] = "2"; t[2, 5] = "8"; t[2, 6] = "C"; t[2, 7] = "3";
            t[2, 8] = "7"; t[2, 9] = "0"; t[2, 10] = "4"; t[2, 11] = "A"; t[2, 12] = "1"; t[2, 13] = "D"; t[2, 14] = "B"; t[2, 15] = "6";
            t[3, 0] = "4"; t[3, 1] = "3"; t[3, 2] = "2"; t[3, 3] = "C"; t[3, 4] = "9"; t[3, 5] = "5"; t[3, 6] = "F"; t[3, 7] = "A";
            t[3, 8] = "B"; t[3, 9] = "E"; t[3, 10] = "1"; t[3, 11] = "7"; t[3, 12] = "6"; t[3, 13] = "0"; t[3, 14] = "8"; t[3, 15] = "D";
            int row = BinToDec("" + input[0] + input[5]);
            int col = BinToDec("" + input[1] + input[2] + input[3] + input[4]);
            return HexToBin(t[row, col]);
        }
        private static String S7(String input)
        {
            String[,] t = new String[4, 16];
            t[0, 0] = "4"; t[0, 1] = "B"; t[0, 2] = "2"; t[0, 3] = "E"; t[0, 4] = "F"; t[0, 5] = "0"; t[0, 6] = "8"; t[0, 7] = "D";
            t[0, 8] = "3"; t[0, 9] = "C"; t[0, 10] = "9"; t[0, 11] = "7"; t[0, 12] = "5"; t[0, 13] = "A"; t[0, 14] = "6"; t[0, 15] = "1";
            t[1, 0] = "D"; t[1, 1] = "0"; t[1, 2] = "B"; t[1, 3] = "7"; t[1, 4] = "4"; t[1, 5] = "9"; t[1, 6] = "1"; t[1, 7] = "A";
            t[1, 8] = "E"; t[1, 9] = "3"; t[1, 10] = "5"; t[1, 11] = "C"; t[1, 12] = "2"; t[1, 13] = "F"; t[1, 14] = "8"; t[1, 15] = "6";
            t[2, 0] = "1"; t[2, 1] = "4"; t[2, 2] = "B"; t[2, 3] = "D"; t[2, 4] = "C"; t[2, 5] = "3"; t[2, 6] = "7"; t[2, 7] = "E";
            t[2, 8] = "A"; t[2, 9] = "F"; t[2, 10] = "6"; t[2, 11] = "8"; t[2, 12] = "0"; t[2, 13] = "5"; t[2, 14] = "9"; t[2, 15] = "2";
            t[3, 0] = "6"; t[3, 1] = "B"; t[3, 2] = "D"; t[3, 3] = "8"; t[3, 4] = "1"; t[3, 5] = "4"; t[3, 6] = "A"; t[3, 7] = "7";
            t[3, 8] = "9"; t[3, 9] = "5"; t[3, 10] = "0"; t[3, 11] = "F"; t[3, 12] = "E"; t[3, 13] = "2"; t[3, 14] = "3"; t[3, 15] = "C";
            int row = BinToDec("" + input[0] + input[5]);
            int col = BinToDec("" + input[1] + input[2] + input[3] + input[4]);
            return HexToBin(t[row, col]);
        }
        private static String S8(String input)
        {
            String[,] t = new String[4, 16];
            t[0, 0] = "D"; t[0, 1] = "2"; t[0, 2] = "8"; t[0, 3] = "4"; t[0, 4] = "6"; t[0, 5] = "F"; t[0, 6] = "B"; t[0, 7] = "1";
            t[0, 8] = "A"; t[0, 9] = "9"; t[0, 10] = "3"; t[0, 11] = "E"; t[0, 12] = "5"; t[0, 13] = "0"; t[0, 14] = "C"; t[0, 15] = "7";
            t[1, 0] = "1"; t[1, 1] = "F"; t[1, 2] = "D"; t[1, 3] = "8"; t[1, 4] = "A"; t[1, 5] = "3"; t[1, 6] = "7"; t[1, 7] = "4";
            t[1, 8] = "C"; t[1, 9] = "5"; t[1, 10] = "6"; t[1, 11] = "B"; t[1, 12] = "0"; t[1, 13] = "E"; t[1, 14] = "9"; t[1, 15] = "2";
            t[2, 0] = "7"; t[2, 1] = "B"; t[2, 2] = "4"; t[2, 3] = "1"; t[2, 4] = "9"; t[2, 5] = "C"; t[2, 6] = "E"; t[2, 7] = "2";
            t[2, 8] = "0"; t[2, 9] = "6"; t[2, 10] = "A"; t[2, 11] = "D"; t[2, 12] = "F"; t[2, 13] = "3"; t[2, 14] = "5"; t[2, 15] = "8";
            t[3, 0] = "2"; t[3, 1] = "1"; t[3, 2] = "E"; t[3, 3] = "7"; t[3, 4] = "4"; t[3, 5] = "A"; t[3, 6] = "8"; t[3, 7] = "D";
            t[3, 8] = "F"; t[3, 9] = "C"; t[3, 10] = "9"; t[3, 11] = "0"; t[3, 12] = "3"; t[3, 13] = "5"; t[3, 14] = "6"; t[3, 15] = "B";
            int row = BinToDec("" + input[0] + input[5]);
            int col = BinToDec("" + input[1] + input[2] + input[3] + input[4]);
            return HexToBin(t[row, col]);
        }
    }
}

